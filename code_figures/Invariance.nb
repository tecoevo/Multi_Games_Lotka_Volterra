(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45419,       1320]
NotebookOptionsPosition[     40599,       1230]
NotebookOutlinePosition[     41021,       1247]
CellTagsIndexPosition[     40978,       1244]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Two player game with two strategies", "Section",
 CellChangeTimes->{{3.790676514840104*^9, 
  3.790676520322887*^9}},ExpressionUUID->"4aaac714-7782-4f9c-a288-\
e86f7a1b8ea1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "j"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790675875476481*^9, 3.790675909934443*^9}, {
  3.790676091908042*^9, 3.7906760936085787`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"41867a74-9e94-4899-8322-392f025c74be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fi", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"j", "=", "1"}], "n"], 
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"i", ",", "j"}], "]"}], 
    SubscriptBox["x", "j"]}]}]}]], "Input",
 CellChangeTimes->{{3.790675803291834*^9, 3.790675822705263*^9}, {
  3.79067587287812*^9, 3.790675895519217*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"c38e80b5-c07e-437a-b4bb-7babaed237c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "1"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2"}]]}]}]], "Output",
 CellChangeTimes->{3.790675828465744*^9, 3.790675912890943*^9, 
  3.7906760949350853`*^9, 3.790944822221133*^9, 3.7909449370898333`*^9, 
  3.790945028449287*^9, 3.861239894374772*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"4318e43e-199d-426c-ac85-ad4b8ee5d384"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fbar", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], "n"], 
   RowBox[{
    SubscriptBox["x", "i"], "fi"}]}]}]], "Input",
 CellChangeTimes->{{3.790675827101469*^9, 3.790675860974032*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"80ac81df-41f7-4ff0-b94e-76a9817169ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.790675847684268*^9, 3.790675861833551*^9}, 
   3.7906759208920107`*^9, 3.7906760980433087`*^9, 3.79094482226871*^9, 
   3.790944937103623*^9, 3.790945028462363*^9, 3.861239894381126*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"23314f62-db63-4958-9c3e-782d369c5aee"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"strategytoedit", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.790944996963272*^9, 3.790945006375805*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c0725341-eb35-4ad7-a5ab-40610786e0af"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "'"}], "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "\[Equal]", "strategytoedit"}], ",", 
    RowBox[{
     SubscriptBox["a", 
      RowBox[{"i", ",", "j"}]], "+", "c"}], ",", 
    SubscriptBox["a", 
     RowBox[{"i", ",", "j"}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.790675938091756*^9, 3.7906759716144114`*^9}, {
   3.790944908986915*^9, 3.790944933190327*^9}, 3.7909449650301447`*^9, 
   3.790945009674412*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"75927c24-2b48-4a95-8d96-678285dd928b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finew", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"j", "=", "1"}], "n"], 
   RowBox[{
    RowBox[{
     RowBox[{"A", "'"}], "[", 
     RowBox[{"i", ",", "j"}], "]"}], 
    SubscriptBox["x", "j"]}]}]}]], "Input",
 CellChangeTimes->{{3.790676111414816*^9, 3.790676115531714*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ca242436-2541-43ac-85b2-57eeef86180f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     SubscriptBox["a", 
      RowBox[{"i", ",", "1"}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2"}]]}]}]], "Output",
 CellChangeTimes->{
  3.7906761161212387`*^9, 3.790944822348806*^9, {3.7909449106338377`*^9, 
   3.7909449371651783`*^9}, 3.790944973472423*^9, 3.79094502852843*^9, 
   3.861239894410995*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"9f97fc61-5235-4649-9587-8da5b0d38ce7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"finew", ",", "c"}], "]"}], "\[Equal]", 
  RowBox[{"fi", "+", 
   RowBox[{"c", " ", 
    SubscriptBox["x", "strategytoedit"]}]}]}]], "Input",
 CellChangeTimes->{{3.7906761265366497`*^9, 3.790676162781918*^9}, 
   3.790944981192761*^9, 3.790945014422551*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"365540ed-6d74-4811-a9a1-3a282a51c373"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.790676131708645*^9, 3.790676163032355*^9, 3.790944822358012*^9, {
   3.790944911598895*^9, 3.790944937217514*^9}, 3.790944985607029*^9, 
   3.790945028580306*^9, 3.861239894416644*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"d08a935e-5650-411b-8880-7ae1857c2622"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fbarnew", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], "n"], 
   RowBox[{
    SubscriptBox["x", "i"], "finew"}]}]}]], "Input",
 CellChangeTimes->{{3.790676184106895*^9, 3.790676193370985*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b6eb40d3-23ae-42a5-abcf-84e450203bd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "1"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "1"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7906761940666237`*^9, 3.790944822407887*^9, {3.790944913970613*^9, 
   3.79094493723177*^9}, 3.7909449906653776`*^9, 3.790945028635356*^9, 
   3.861239894436426*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"aeee0ebc-40b4-44fb-998e-9187034d6830"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"fbarnew", ",", "c"}], "]"}], "\[Equal]", 
    RowBox[{"fbar", "+", 
     RowBox[{"c", " ", 
      SubscriptBox["x", "strategytoedit"]}]}]}], " ", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "n"], 
       SubscriptBox["x", "i"]}], "\[Equal]", "1"}], "}"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.790676200611713*^9, 3.790676352625594*^9}, {
   3.790676408406251*^9, 3.790676435489886*^9}, 3.790945017918474*^9, 
   3.861239904849085*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"c3d48069-ed70-4b3e-9253-79f328627887"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7906762077809153`*^9, 3.790676228347177*^9}, {
   3.7906762777720957`*^9, 3.790676353008383*^9}, {3.79067643114421*^9, 
   3.7906764358352423`*^9}, 3.790944822467293*^9, {3.7909449153893437`*^9, 
   3.7909449372838573`*^9}, 3.790945028647681*^9, 3.861239905674014*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"ce71db5d-f99e-4c5e-bfc2-871f8d091e4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"finew", "-", "fbarnew"}], ",", "c"}], "]"}], "\[Equal]", 
    RowBox[{"fi", "+", 
     RowBox[{"c", " ", 
      SubscriptBox["x", "strategytoedit"]}], "-", "fbar", "-", 
     RowBox[{"c", " ", 
      SubscriptBox["x", "strategytoedit"]}]}]}], " ", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "n"], 
       SubscriptBox["x", "i"]}], "\[Equal]", "1"}], "}"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.79067646101836*^9, 3.790676489901132*^9}, {
  3.790945021854835*^9, 3.790945023715002*^9}, {3.861239865626132*^9, 
  3.861239878308612*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8cc19674-f133-4517-9438-2dab40bc9539"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.790676495099592*^9, 3.790944822479758*^9, {3.790944917458042*^9, 
   3.790944937296836*^9}, 3.790945028710003*^9, 3.861239898280031*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"98d1be09-0b83-4c0b-b0ef-1e48f5cc5d28"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Three player game with two strategies", "Section",
 CellChangeTimes->{{3.790676514840104*^9, 
  3.790676532859539*^9}},ExpressionUUID->"bf9fceac-5715-45ef-b8ad-\
40f02d85711a"],

Cell[TextData[{
 "Number of strategies is ",
 StyleBox["n",
  FontSlant->"Italic"],
 " and the payoff tensor ",
 StyleBox["A",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.858354963631592*^9, 
  3.858354977326046*^9}},ExpressionUUID->"43cc2f4d-a4b2-44b0-8b62-\
4c5a366c6c34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "j", ",", "k"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790675875476481*^9, 3.790675909934443*^9}, {
   3.790676091908042*^9, 3.7906760936085787`*^9}, {3.790676576844709*^9, 
   3.79067657995733*^9}, {3.858354887077157*^9, 3.85835491398711*^9}, {
   3.858354956283143*^9, 3.858354961894847*^9}, 3.893659321869052*^9, 
   3.893659401110527*^9, 3.893659450004239*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"9075ed73-5054-4d71-9c24-94a70593bbe6"],

Cell[TextData[{
 "The fitness of strategy ",
 StyleBox["i",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.858354986158593*^9, 3.858354993586213*^9}, {
  3.893659402092813*^9, 
  3.893659404558196*^9}},ExpressionUUID->"ad0c1428-0f12-4204-9911-\
57cf413df1d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fi", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"j", "=", "1"}], "n"], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "1"}], "n"], 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], 
     SubscriptBox["x", "j"], 
     SubscriptBox["x", "k"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.790675803291834*^9, 3.790675822705263*^9}, {
   3.79067587287812*^9, 3.790675895519217*^9}, {3.790676597613245*^9, 
   3.790676622453725*^9}, {3.858354927198291*^9, 3.858354949657189*^9}, 
   3.858355269825563*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"55ae0c54-44da-47a3-9149-23b32b736d58"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubsuperscriptBox["x", "1", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "1", ",", "1"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "1", ",", "2"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "3"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "1", ",", "3"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2", ",", "1"}]]}], "+", 
  RowBox[{
   SubsuperscriptBox["x", "2", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2", ",", "2"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["x", "3"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2", ",", "3"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "3"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "3", ",", "1"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["x", "3"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "3", ",", "2"}]]}], "+", 
  RowBox[{
   SubsuperscriptBox["x", "3", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "3", ",", "3"}]]}]}]], "Output",
 CellChangeTimes->{3.790675828465744*^9, 3.790675912890943*^9, 
  3.7906760949350853`*^9, 3.790676628747636*^9, 3.7906794510056667`*^9, 
  3.790945087437928*^9, 3.861239915568886*^9, 3.893659323842602*^9, 
  3.893659407491261*^9, 3.893659453470874*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"61215c62-2089-48f8-8cc9-370ff2d26e58"]
}, Open  ]],

Cell["Average payoff of the population", "Text",
 CellChangeTimes->{{3.858355010732795*^9, 
  3.8583550266659403`*^9}},ExpressionUUID->"a3714af8-c481-4792-a164-\
731f24ac653b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fbar", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], "n"], 
   RowBox[{
    SubscriptBox["x", "i"], "fi"}]}]}]], "Input",
 CellChangeTimes->{{3.790675827101469*^9, 3.790675860974032*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"24e89fca-1aaf-42e9-8563-27b090b2817d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["x", "1", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "1", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "1", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "1", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2", ",", "1"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "2", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "3", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "3", ",", "2"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "3", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "3", ",", "3"}]]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["x", "1", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "1", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "1", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "1", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2", ",", "1"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "2", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "3", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "3", ",", "2"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "3", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "3", ",", "3"}]]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["x", "1", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "1", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "1", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "1", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "2", ",", "1"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "2", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "2", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "2", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3", ",", "2"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "3", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3", ",", "3"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.790675847684268*^9, 3.790675861833551*^9}, 
   3.7906759208920107`*^9, 3.7906760980433087`*^9, 3.7906766921494093`*^9, 
   3.790679451020269*^9, 3.790945090732935*^9, 3.86123991557436*^9, 
   3.893659325572762*^9, 3.893659408933711*^9, 3.893659453481196*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"9f847d9a-1da3-4dff-88a4-631071bcadb3"]
}, Open  ]],

Cell[TextData[{
 "This is the strategy we choose to remove by adding a constant ",
 StyleBox["c",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.858355035628197*^9, 3.858355046839573*^9}, {
  3.858355094166901*^9, 
  3.85835509915727*^9}},ExpressionUUID->"aa8b9826-ac41-4dfd-bd69-\
80abdd820d53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"strategytoedit", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.79094510945682*^9, 3.790945111215711*^9}, 
   3.7909451593364697`*^9, 3.861239929798538*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"d17509a0-7461-4e79-a27d-c0e1f16d2f9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "'"}], "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"j", "\[Equal]", "strategytoedit"}], ",", 
    RowBox[{
     SubscriptBox["a", 
      RowBox[{"i", ",", "j", ",", "k"}]], "+", "c"}], ",", 
    SubscriptBox["a", 
     RowBox[{"i", ",", "j", ",", "k"}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.790675938091756*^9, 3.7906759716144114`*^9}, {
   3.790676717541992*^9, 3.790676746434997*^9}, 3.790679435585121*^9, 
   3.790679629195348*^9, 3.790945114430608*^9, 3.790945243951012*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"714eee8e-50ce-4478-be54-ffdb016b70ba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "'"}], "[", 
     RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7906771655924067`*^9, 3.790677202882594*^9}, {
  3.790677301841464*^9, 3.790677305282778*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a177219a-eeca-48d2-9fdf-1d2c281e826d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"1", ",", "1", ",", "1"}]]}]},
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"2", ",", "1", ",", "1"}]]}]},
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"3", ",", "1", ",", "1"}]]}]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           SubscriptBox["a", 
            RowBox[{"1", ",", "2", ",", "1"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"2", ",", "2", ",", "1"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"3", ",", "2", ",", "1"}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           SubscriptBox["a", 
            RowBox[{"1", ",", "3", ",", "1"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"2", ",", "3", ",", "1"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"3", ",", "3", ",", "1"}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"1", ",", "1", ",", "2"}]]}]},
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"2", ",", "1", ",", "2"}]]}]},
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"3", ",", "1", ",", "2"}]]}]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           SubscriptBox["a", 
            RowBox[{"1", ",", "2", ",", "2"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"2", ",", "2", ",", "2"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"3", ",", "2", ",", "2"}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           SubscriptBox["a", 
            RowBox[{"1", ",", "3", ",", "2"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"2", ",", "3", ",", "2"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"3", ",", "3", ",", "2"}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"1", ",", "1", ",", "3"}]]}]},
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"2", ",", "1", ",", "3"}]]}]},
          {
           RowBox[{"c", "+", 
            SubscriptBox["a", 
             RowBox[{"3", ",", "1", ",", "3"}]]}]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           SubscriptBox["a", 
            RowBox[{"1", ",", "2", ",", "3"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"2", ",", "2", ",", "3"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"3", ",", "2", ",", "3"}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           SubscriptBox["a", 
            RowBox[{"1", ",", "3", ",", "3"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"2", ",", "3", ",", "3"}]]},
          {
           SubscriptBox["a", 
            RowBox[{"3", ",", "3", ",", "3"}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7906771918942423`*^9, 3.790677203262536*^9}, 
   3.790677305874535*^9, 3.7906794556222754`*^9, 3.7906796395343113`*^9, {
   3.790945155982451*^9, 3.790945161442226*^9}, 3.790945255241769*^9, {
   3.861239915598819*^9, 3.8612399319792547`*^9}, 3.893659330072797*^9, 
   3.893659412435896*^9, 3.893659453531494*^9},
 CellLabel->
  "Out[31]//MatrixForm=",ExpressionUUID->"4a75bec9-9696-43f4-bacf-\
a308d8bfb00a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finew", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"j", "=", "1"}], "n"], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "1"}], "n"], 
    RowBox[{
     RowBox[{
      RowBox[{"A", "'"}], "[", 
      RowBox[{"i", ",", "j", ",", "k"}], "]"}], 
     SubscriptBox["x", "j"], 
     SubscriptBox["x", "k"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.790676111414816*^9, 3.790676115531714*^9}, {
   3.7906770478107038`*^9, 3.790677059673457*^9}, 3.790677109793352*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"d19db366-9bcc-4010-b3f6-4db2a3d30e27"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubsuperscriptBox["x", "1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     SubscriptBox["a", 
      RowBox[{"i", ",", "1", ",", "1"}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     SubscriptBox["a", 
      RowBox[{"i", ",", "1", ",", "2"}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "3"], " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     SubscriptBox["a", 
      RowBox[{"i", ",", "1", ",", "3"}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2", ",", "1"}]]}], "+", 
  RowBox[{
   SubsuperscriptBox["x", "2", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2", ",", "2"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["x", "3"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "2", ",", "3"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["x", "3"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "3", ",", "1"}]]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   SubscriptBox["x", "3"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "3", ",", "2"}]]}], "+", 
  RowBox[{
   SubsuperscriptBox["x", "3", "2"], " ", 
   SubscriptBox["a", 
    RowBox[{"i", ",", "3", ",", "3"}]]}]}]], "Output",
 CellChangeTimes->{
  3.7906761161212387`*^9, {3.790677042408386*^9, 3.790677060171214*^9}, 
   3.790677111247719*^9, 3.790679466770259*^9, 3.7906796411538568`*^9, 
   3.790945198241682*^9, 3.790945263950143*^9, {3.8612399156048527`*^9, 
   3.86123993291693*^9}, 3.893659331824407*^9, {3.8936594284456983`*^9, 
   3.893659453542064*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"d1f8eff8-b752-4362-9bb9-ab88133f12cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"finew", ",", "c"}], "]"}], "-", "fi"}], "\[Equal]", "0"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.7906761265366497`*^9, 3.790676162781918*^9}, {
  3.790677078296134*^9, 3.790677094509349*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"dde0c59c-cddd-4080-82c0-d9eaea253476"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SubscriptBox["x", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "1"], "+", 
     SubscriptBox["x", "2"], "+", 
     SubscriptBox["x", "3"]}], ")"}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.790676131708645*^9, 3.790676163032355*^9, {3.790677082691339*^9, 
   3.790677112266624*^9}, {3.790679469822967*^9, 3.790679474783061*^9}, 
   3.790679642340688*^9, 3.790945201901237*^9, 3.7909452640181303`*^9, {
   3.8612399156209507`*^9, 3.861239933746887*^9}, 3.89365933421161*^9, {
   3.893659429594187*^9, 3.893659453574642*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"d89bd936-7016-439f-a0fe-41d1c0b32a97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fbarnew", "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], "n"], 
   RowBox[{
    SubscriptBox["x", "i"], "finew"}]}]}]], "Input",
 CellChangeTimes->{{3.790676184106895*^9, 3.790676193370985*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"a8f45264-e088-40e8-92ff-d9383e0dc0e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["x", "1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "1", ",", "1"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "1", ",", "2"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "1", ",", "3"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2", ",", "1"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "2", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "2", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "3", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "3", ",", "2"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "3", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"1", ",", "3", ",", "3"}]]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["x", "1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "1", ",", "1"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "1", ",", "2"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "1", ",", "3"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2", ",", "1"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "2", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "3", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "3", ",", "2"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "3", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "3", ",", "3"}]]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["x", "1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"3", ",", "1", ",", "1"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"3", ",", "1", ",", "2"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        SubscriptBox["a", 
         RowBox[{"3", ",", "1", ",", "3"}]]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "2", ",", "1"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "2", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "2", ",", "2"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "2", ",", "3"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3", ",", "1"}]]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3", ",", "2"}]]}], "+", 
     RowBox[{
      SubsuperscriptBox["x", "3", "2"], " ", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3", ",", "3"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7906761940666237`*^9, 3.790677432110145*^9, 3.7906794981199903`*^9, 
   3.790679644942555*^9, 3.790945207661711*^9, 3.790945264063838*^9, {
   3.86123991562606*^9, 3.861239937317349*^9}, 3.8936593363299427`*^9, {
   3.893659431693558*^9, 3.893659453585396*^9}},
 CellLabel->"Out[34]=",ExpressionUUID->"80f89752-b7b2-4729-840d-a02bc0f49743"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"fbarnew", ",", "c"}], "]"}], "\[Equal]", 
    RowBox[{"fbar", "+", 
     RowBox[{"c", " ", 
      SubscriptBox["x", "strategytoedit"]}]}]}], " ", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "n"], 
       SubscriptBox["x", "i"]}], "\[Equal]", "1"}], "}"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.790676200611713*^9, 3.790676352625594*^9}, {
   3.790676408406251*^9, 3.790676435489886*^9}, 3.790679657067225*^9, 
   3.790945211490348*^9, 3.8612399182768297`*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"ddf3e630-5dbe-4c81-b425-7cb2fef1c648"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7906762077809153`*^9, 3.790676228347177*^9}, {
   3.7906762777720957`*^9, 3.790676353008383*^9}, {3.79067643114421*^9, 
   3.7906764358352423`*^9}, 3.790677434733406*^9, 3.790679499521587*^9, 
   3.790679657648234*^9, 3.790945216048682*^9, 3.790945264112961*^9, {
   3.86123991564227*^9, 3.861239938242587*^9}, 3.8936593397102003`*^9, {
   3.893659437063888*^9, 3.893659453618125*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"44cad75c-ba6b-4cbd-84fb-06d9e8d86304"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"finew", "-", "fbarnew"}], ",", "c"}], "]"}], "\[Equal]", 
    RowBox[{"fi", "+", 
     RowBox[{"c", " ", 
      SubscriptBox["x", "strategytoedit"]}], "-", "fbar", "-", 
     RowBox[{"c", " ", 
      SubscriptBox["x", "strategytoedit"]}]}]}], " ", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], "n"], 
       SubscriptBox["x", "i"]}], "\[Equal]", "1"}], "}"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.79067646101836*^9, 3.790676489901132*^9}, {
   3.7906796634882927`*^9, 3.790679665950446*^9}, {3.790945219837736*^9, 
   3.790945222035321*^9}, 3.861239920093065*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"7ba3273b-e9a7-4309-b270-12cef4c28e1d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.790676495099592*^9, 3.790677435855521*^9, 3.790679666300784*^9, 
   3.790945223735063*^9, 3.790945264123373*^9, {3.861239915648679*^9, 
   3.861239939206041*^9}, 3.8936593421315517`*^9, {3.893659437841456*^9, 
   3.893659453650557*^9}},
 CellLabel->"Out[36]=",ExpressionUUID->"a54c547b-558e-4482-879e-29570e782a5b"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{101, Automatic}, {-229, Automatic}},
Magnification->1.5,
FrontEndVersion->"14.0 for Mac OS X x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fa9cb35b-3358-45b7-b2f5-c8820ebd616d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 180, 3, 101, "Section",ExpressionUUID->"4aaac714-7782-4f9c-a288-e86f7a1b8ea1"],
Cell[763, 27, 437, 11, 79, "Input",ExpressionUUID->"41867a74-9e94-4899-8322-392f025c74be"],
Cell[CellGroupData[{
Cell[1225, 42, 423, 11, 84, "Input",ExpressionUUID->"c38e80b5-c07e-437a-b4bb-7babaed237c0"],
Cell[1651, 55, 500, 13, 54, "Output",ExpressionUUID->"4318e43e-199d-426c-ac85-ad4b8ee5d384"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2188, 73, 322, 8, 81, "Input",ExpressionUUID->"80ac81df-41f7-4ff0-b94e-76a9817169ec"],
Cell[2513, 83, 951, 29, 55, "Output",ExpressionUUID->"23314f62-db63-4958-9c3e-782d369c5aee"]
}, Open  ]],
Cell[3479, 115, 224, 4, 46, "Input",ExpressionUUID->"c0725341-eb35-4ad7-a5ab-40610786e0af"],
Cell[3706, 121, 604, 16, 49, "Input",ExpressionUUID->"75927c24-2b48-4a95-8d96-678285dd928b"],
Cell[CellGroupData[{
Cell[4335, 141, 399, 11, 84, "Input",ExpressionUUID->"ca242436-2541-43ac-85b2-57eeef86180f"],
Cell[4737, 154, 561, 16, 55, "Output",ExpressionUUID->"9f97fc61-5235-4649-9587-8da5b0d38ce7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5335, 175, 397, 9, 48, "Input",ExpressionUUID->"365540ed-6d74-4811-a9a1-3a282a51c373"],
Cell[5735, 186, 318, 5, 52, "Output",ExpressionUUID->"d08a935e-5650-411b-8880-7ae1857c2622"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6090, 196, 328, 8, 81, "Input",ExpressionUUID->"b6eb40d3-23ae-42a5-abcf-84e450203bd6"],
Cell[6421, 206, 1050, 34, 55, "Output",ExpressionUUID->"aeee0ebc-40b4-44fb-998e-9187034d6830"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7508, 245, 745, 20, 81, "Input",ExpressionUUID->"c3d48069-ed70-4b3e-9253-79f328627887"],
Cell[8256, 267, 401, 5, 52, "Output",ExpressionUUID->"ce71db5d-f99e-4c5e-bfc2-871f8d091e4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8694, 277, 861, 23, 81, "Input",ExpressionUUID->"8cc19674-f133-4517-9438-2dab40bc9539"],
Cell[9558, 302, 271, 4, 52, "Output",ExpressionUUID->"98d1be09-0b83-4c0b-b0ef-1e48f5cc5d28"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9878, 312, 182, 3, 101, "Section",ExpressionUUID->"bf9fceac-5715-45ef-b8ad-40f02d85711a"],
Cell[10063, 317, 286, 10, 53, "Text",ExpressionUUID->"43cc2f4d-a4b2-44b0-8b62-4c5a366c6c34"],
Cell[10352, 329, 674, 14, 79, "Input",ExpressionUUID->"9075ed73-5054-4d71-9c24-94a70593bbe6"],
Cell[11029, 345, 269, 8, 53, "Text",ExpressionUUID->"ad0c1428-0f12-4204-9911-57cf413df1d5"],
Cell[CellGroupData[{
Cell[11323, 357, 676, 17, 84, "Input",ExpressionUUID->"55ae0c54-44da-47a3-9149-23b32b736d58"],
Cell[12002, 376, 1616, 48, 54, "Output",ExpressionUUID->"61215c62-2089-48f8-8cc9-370ff2d26e58"]
}, Open  ]],
Cell[13633, 427, 176, 3, 53, "Text",ExpressionUUID->"a3714af8-c481-4792-a164-731f24ac653b"],
Cell[CellGroupData[{
Cell[13834, 434, 323, 8, 81, "Input",ExpressionUUID->"24e89fca-1aaf-42e9-8563-27b090b2817d"],
Cell[14160, 444, 4785, 144, 125, "Output",ExpressionUUID->"9f847d9a-1da3-4dff-88a4-631071bcadb3"]
}, Open  ]],
Cell[18960, 591, 306, 8, 53, "Text",ExpressionUUID->"aa8b9826-ac41-4dfd-bd69-80abdd820d53"],
Cell[19269, 601, 274, 5, 46, "Input",ExpressionUUID->"d17509a0-7461-4e79-a27d-c0e1f16d2f9c"],
Cell[19546, 608, 678, 16, 49, "Input",ExpressionUUID->"714eee8e-50ce-4478-be54-ffdb016b70ba"],
Cell[CellGroupData[{
Cell[20249, 628, 604, 16, 46, "Input",ExpressionUUID->"a177219a-eeca-48d2-9fdf-1d2c281e826d"],
Cell[20856, 646, 7795, 222, 306, "Output",ExpressionUUID->"4a75bec9-9696-43f4-bacf-a308d8bfb00a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28688, 873, 604, 16, 84, "Input",ExpressionUUID->"d19db366-9bcc-4010-b3f6-4db2a3d30e27"],
Cell[29295, 891, 1860, 56, 55, "Output",ExpressionUUID->"d1f8eff8-b752-4362-9bb9-ab88133f12cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31192, 952, 377, 9, 46, "Input",ExpressionUUID->"dde0c59c-cddd-4080-82c0-d9eaea253476"],
Cell[31572, 963, 684, 15, 52, "Output",ExpressionUUID->"d89bd936-7016-439f-a0fe-41d1c0b32a97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32293, 983, 329, 8, 81, "Input",ExpressionUUID->"a8f45264-e088-40e8-92ff-d9383e0dc0e2"],
Cell[32625, 993, 5321, 163, 125, "Output",ExpressionUUID->"80f89752-b7b2-4729-840d-a02bc0f49743"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37983, 1161, 769, 20, 81, "Input",ExpressionUUID->"ddf3e630-5dbe-4c81-b425-7cb2fef1c648"],
Cell[38755, 1183, 518, 7, 52, "Output",ExpressionUUID->"44cad75c-ba6b-4cbd-84fb-06d9e8d86304"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39310, 1195, 887, 23, 81, "Input",ExpressionUUID->"7ba3273b-e9a7-4309-b270-12cef4c28e1d"],
Cell[40200, 1220, 371, 6, 52, "Output",ExpressionUUID->"a54c547b-558e-4482-879e-29570e782a5b"]
}, Open  ]]
}, Open  ]]
}
]
*)

